'((((T 20 44 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
    NIL 70 0 0)
   70 2 1 24/7 31/7)
  (((2 T 44 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
    NIL 70 0 0)
   70 20 1 300/101 401/101)
  (((2 20 T NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
    NIL 70 0 0)
   70 44 1 156/77 233/77))


;;

'(((2 20 T NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
  (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   NIL 70 0 0)
  70 44 1 156/77 233/77)


;;;; ABERTOs
'((((T 20 44 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
    NIL 70 0 0)
   70 2 1 24/7 31/7)
  (((2 T 44 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
    NIL 70 0 0)
   70 20 1 300/101 401/101)
  (((2 20 T NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
    NIL 70 0 0)
   70 44 1 156/77 233/77))


;;;;;;;;;;;
;;fehcados
'((((2 20 T NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
    NIL 70 0 0)
   70 44 1 156/77 233/77))

;;; 2nd espacao

'((((2 20 NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL T 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   (((2 20 T NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
    (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
      (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
      (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
      (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
      (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
      (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
      (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
      (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
      (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
      (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
     NIL 70 0 0)
    70 44 1 156/77 233/77)
   70 47 2 115/74 263/74))

;; ABERTOS SEM O QUE TAVA EM FECHADOS
'((((T 20 44 NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
  (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   NIL 70 0 0)
  70 2 1 24/7 31/7)

 (((2 T 44 NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
  (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   NIL 70 0 0)
  70 20 1 300/101 401/101)

 (((2 20 T NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
  (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   NIL 70 0 0)
  70 44 1 156/77 233/77)

 (((2 20 NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL T 30 NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
   (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
  (((2 20 T NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
    (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
   (((2 20 44 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL 3 30 NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL 22 NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL)
     (NIL NIL NIL NIL NIL NIL NIL NIL NIL NIL))
    NIL 70 0 0)
   70 44 1 156/77 233/77)
  70 47 2 115/74 263/74))









(defun order-queue (queue)
  (cond
    ((null queue) nil)
    (t 
      (append 
        (order-queue (remove-if (lambda (node) (> (node-heuristic node) (node-heuristic (car queue)))) (cdr queue)))
        (list (car queue))
        (order-queue (remove-if (lambda (node) (<= (node-heuristic node) (node-heuristic (car queue)))) (cdr queue)))
      )
    )
  )
)

(defun a-star (node &optional (heuristic-function 'calculate-heuristic-default))
  (let ((queue (list node))
      (visited '()))
    (loop while queue do
      (let ((current (pop queue)))
        (if (is-solution current) 
          (return (create-solution-node current (length queue) (length visited)))
          (progn
            (do* ((children (generate-children current) (cdr children))) ((null children)) 
              (let* (
                  (child (funcall heuristic-function (car children)))
                  (found-in-queue (find child queue :key #'node-board))
                  (found-in-visited (find child visited :key #'node-board))
                )
                (cond
                  (found-in-queue 
                    (if (> (node-heuristic found-in-queue) (node-heuristic child)) 
                      (setq queue (order-queue (cons child (remove found-in-queue queue))))
                    )
                  )
                  (found-in-visited 
                    (if (> (node-heuristic found-in-visited) (node-heuristic child)) 
                      (setq visited (remove found-in-visited visited) queue (order-queue (cons child queue)))
                    )
                  )
                  (t (setq queue (order-queue (cons child queue))))
                )
              )
            )
          )
        )
        (push current visited)
      )
    )
  )
)






(defun a*-aux (abertos fechados expandir-nos fn-calcular-pontos fn-heuristica)
  (if (null abertos)
      '() ; Falha se ABERTOS está vazia.
      (let* ((no-atual (car (ordenar-por-f abertos))) ; Remove nó com menor f de ABERTOS.
             (novos-fechados (adicionar-ordenado-f no-atual fechados)) ; Coloca nó em FECHADOS por ordem de f.
             (sucessores (funcall expandir-nos no-atual)))
        (if (algum-objetivo-p sucessores)
            (caminho-solucao-a* no-atual) ; Se algum sucessor é um nó objetivo, retorna a solução.
            (let* ((novos-abertos (append (cdr abertos) sucessores))
                   (novos-fechados (atualizar-f-nos novos-fechados sucessores)))
              (a*-aux novos-abertos novos-fechados expandir-nos fn-calcular-pontos fn-heuristica))))))